# RFC-009: Data Ground Truth Policy & Centralized API Control

**Status**: ğŸŸ¢ Approved  
**Created**: 2026-01-22  
**Author**: Council of Six  
**Supersedes**: Partial policies from RFC-007, RFC-008  
**Related**: RFC-007 (Collector Isolation), RFC-008 (Tick Completeness QA), ISSUE-031 (Hybrid Recovery)

---

## 1. Executive Summary

ë³¸ RFCëŠ” ì‹œìŠ¤í…œì˜ **ë°ì´í„° ì°¸ê°’(Ground Truth) ì •ì±…**ê³¼ **REST API ì¤‘ì•™ ì§‘ì¤‘ì‹ í†µì œ ì „ëµ**ì„ í™•ë¦½í•©ë‹ˆë‹¤. ë°±í…ŒìŠ¤íŒ… ë° ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµ ë°ì´í„°ì˜ ì‹ ë¢°ë„ë¥¼ ë³´ì¥í•˜ê³ , ì™¸ë¶€ API í˜¸ì¶œëŸ‰ ì œí•œìœ¼ë¡œ ì¸í•œ ì‹œìŠ¤í…œ ë§ˆë¹„ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ëª…í™•í•œ ê·œì¹™ì„ ì •ì˜í•©ë‹ˆë‹¤.

### í•µì‹¬ ê²°ì •ì‚¬í•­
1. **REST API ë¶„ë´‰ = ìœ ì¼í•œ ì°¸ê°’(Ground Truth)**
2. **ëª¨ë“  REST API í˜¸ì¶œì€ RedisRateLimiter ê²½ìœ  í•„ìˆ˜**
3. **GatewayWorker ë°°í¬ë¥¼ P0 ìš°ì„ ìˆœìœ„ë¡œ ìƒí–¥**

---

## 2. Motivation

### 2.1 ë¬¸ì œì  (Current Issues)

#### A. ì°¸ê°’ ì •ì±…ì˜ ëª¨í˜¸í•¨
- RFC-008ì—ì„œ "í‹± ë°ì´í„°ë¥¼ Ground Truthë¡œ ê°„ì£¼"í•˜ëŠ” ì¡°í•­ê³¼ "REST API Volume Check" ì „ëµì´ í˜¼ì¬
- `impute_final_candles.py`ì—ì„œ "Volumeì´ í° ìª½ ì„ íƒ" ë°©ì‹ ì‚¬ìš© â†’ ì¼ê´€ì„± ì—†ìŒ
- ë°±í…ŒìŠ¤íŒ… ì‹œ ì–´ë–¤ ë°ì´í„°ë¥¼ ì‹ ë¢°í•´ì•¼ í• ì§€ ë¶ˆëª…í™•

#### B. API í†µì œì˜ ë¶ˆì™„ì „ì„±
- `BackfillManager`: ê°œë³„ `sleep(0.06)` ì‚¬ìš© (ì „ì—­ ì œì–´ ì—†ìŒ)
- `RecoveryOrchestrator`: Rate Limiter ë¯¸ì ìš©
- ì¼ë¶€ ê²€ì¦ ì›Œì»¤ë§Œ `gatekeeper` ì‚¬ìš© â†’ ë©€í‹° ì›Œì»¤ í™˜ê²½ì—ì„œ 429 ì—ëŸ¬ ìœ„í—˜

### 2.2 ë¹„ì¦ˆë‹ˆìŠ¤ ì˜í–¥

| ì´ìŠˆ | ì˜í–¥ | ì‹¬ê°ë„ |
|------|------|--------|
| ì°¸ê°’ ë¶ˆëª…í™• | ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ ì‹ ë¢°ë„ í•˜ë½, ë²•ì  ë¦¬ìŠ¤í¬ | **HIGH** |
| API í†µì œ ì‹¤íŒ¨ | í”„ë¡œë•ì…˜ í‚¤ ì†Œì§„, ì„œë¹„ìŠ¤ ì¤‘ë‹¨ | **CRITICAL** |
| ë°ì´í„° ì¼ê´€ì„± ë¶€ì¡± | ì „ëµ ê°œë°œ íš¨ìœ¨ì„± ì €í•˜ | **MEDIUM** |

---

## 3. Ground Truth Policy

### 3.1 ì°¸ê°’ ìš°ì„ ìˆœìœ„ (Priority Hierarchy)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ REST API ë¶„ë´‰ (ì°¸ê°’)                            â”‚
â”‚    - KIS: FHKST03010200 (êµ­ë‚´ ë¶„ë´‰)                â”‚
â”‚    - Kiwoom: ka10080 (êµ­ë‚´ ë¶„ë´‰)                   â”‚
â”‚    - ê±°ë˜ì†Œ ê³µì‹ ë°ì´í„°, ë²•ì  íš¨ë ¥ ìˆìŒ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (ëˆ„ë½ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ ê²€ì¦ëœ í‹± ì§‘ê³„ ë¶„ë´‰                             â”‚
â”‚    - Volume Check í†µê³¼ (ì˜¤ì°¨ < 0.1%)               â”‚
â”‚    - ì‹¤ì‹œê°„ì„± ì¤‘ìš” ì‹œ ì‚¬ìš© ê°€ëŠ¥                      â”‚
â”‚    - ì¼ì¼ ê²€ì¦ í•„ìˆ˜                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (ê²€ì¦ ì‹¤íŒ¨ ì‹œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ Manual Review & ë³µêµ¬                           â”‚
â”‚    - ë°ì´í„° ëˆ„ë½/ë¶ˆì¼ì¹˜ êµ¬ê°„                        â”‚
â”‚    - ìˆ˜ë™ ê²€ì¦ í›„ ì‚¬ìš©                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë³„ ì •ì±…

| ìš©ë„ | ì‚¬ìš© ë°ì´í„° | ê·¼ê±° |
|------|------------|------|
| **ë°±í…ŒìŠ¤íŒ…** | REST API ë¶„ë´‰ (1ìˆœìœ„) | ì¬í˜„ ê°€ëŠ¥ì„±, ë²•ì  íš¨ë ¥ |
| **ML í•™ìŠµ** | REST API ë¶„ë´‰ (1ìˆœìœ„) | ëª¨ì§‘ë‹¨ ë°ì´í„°, ì™„ì „ì„± |
| **ì‹¤ì‹œê°„ ì•Œê³ ë¦¬ì¦˜** | ê²€ì¦ëœ í‹± ì§‘ê³„ (2ìˆœìœ„) | ì†ë„ ìš°ì„ , ê²€ì¦ í•„ìˆ˜ |
| **í’ˆì§ˆ ë¦¬í¬íŒ…** | REST API ë¶„ë´‰ (1ìˆœìœ„) | ê°ì‚¬ ëŒ€ì‘, ì¬í˜„ ê°€ëŠ¥ |

### 3.3 Database Schema

#### `market_candles` í…Œì´ë¸” í™•ì¥
```sql
ALTER TABLE market_candles 
ADD COLUMN source_type VARCHAR(50) DEFAULT 'TICK_AGGREGATION_UNVERIFIED';

-- Enum Values:
-- 'REST_API_KIS'               : KIS REST API ë¶„ë´‰ (ì°¸ê°’)
-- 'REST_API_KIWOOM'            : Kiwoom REST API ë¶„ë´‰ (ì°¸ê°’)
-- 'TICK_AGGREGATION_VERIFIED'  : Volume Check í†µê³¼ (ì¤€ì°¸ê°’)
-- 'TICK_AGGREGATION_UNVERIFIED': ë¯¸ê²€ì¦ í‹± ì§‘ê³„ (ì„ì‹œ)
```

#### ì¿¼ë¦¬ ì˜ˆì‹œ
```sql
-- ë°±í…ŒìŠ¤íŒ…ìš© ì°¸ê°’ë§Œ ì¡°íšŒ
SELECT * FROM market_candles 
WHERE source_type IN ('REST_API_KIS', 'REST_API_KIWOOM')
  AND symbol = '005930'
  AND time BETWEEN '2026-01-20 09:00' AND '2026-01-20 15:30';

-- ì‹¤ì‹œê°„ ì•Œê³ ë¦¬ì¦˜ìš© (ê²€ì¦ëœ ë°ì´í„°ë§Œ)
SELECT * FROM market_candles 
WHERE source_type IN ('REST_API_KIS', 'TICK_AGGREGATION_VERIFIED')
  AND symbol = '005930'
ORDER BY time DESC LIMIT 100;
```

---

## 4. Centralized API Control

### 4.1 ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          All REST API Requests (KIS/Kiwoom)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   RedisRateLimiter       â”‚
        â”‚    (gatekeeper)          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚ KIS:    30 req/s   â”‚  â”‚
        â”‚  â”‚ KIWOOM: 30 req/s   â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ Token Bucket (Lua Script)
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    External API          â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚  KIS   â”‚  â”‚ Kiwoom â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ê°•ì œ ê·œì¹™ (Enforcement Rules)

#### Rule 1: ëª¨ë“  REST API í˜¸ì¶œì€ gatekeeper ê²½ìœ 
```python
# âŒ ì˜ëª»ëœ ì˜ˆì‹œ (ê¸ˆì§€)
async with session.get(kis_url, headers=headers) as resp:
    data = await resp.json()

# âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ (í•„ìˆ˜)
from src.api_gateway.rate_limiter import gatekeeper

if await gatekeeper.wait_acquire("KIS", timeout=10.0):
    async with session.get(kis_url, headers=headers) as resp:
        data = await resp.json()
else:
    logger.warning("Rate limit timeout, skipping request")
```

#### Rule 2: íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬ í•„ìˆ˜
```python
# Timeoutì€ ìµœëŒ€ 10ì´ˆë¡œ ì œí•œ
await gatekeeper.wait_acquire("KIS", timeout=10.0)

# Timeout ë°œìƒ ì‹œ graceful degradation
if not acquired:
    # ë³µêµ¬ ì‘ì—… ì—°ê¸°, ì•Œë¦¼ ë°œì†¡ ë“±
    await queue_for_retry(request)
```

### 4.3 ì ìš© ëŒ€ìƒ ëª¨ë“ˆ

| ëª¨ë“ˆ | í˜„ì¬ ìƒíƒœ | ì¡°ì¹˜ í•„ìš” |
|------|-----------|----------|
| `collector_kis.py` | âœ… ì ìš© ì™„ë£Œ | - |
| `collector_kiwoom.py` | âœ… ì ìš© ì™„ë£Œ | - |
| **`BackfillManager`** | âŒ ë¯¸ì ìš© | **ì¦‰ì‹œ ìˆ˜ì • í•„ìš”** |
| **`RecoveryOrchestrator`** | âŒ ë¯¸ì ìš© | **ì¦‰ì‹œ ìˆ˜ì • í•„ìš”** |
| `impute_final_candles.py` | âŒ ë¯¸ì ìš© | ìˆ˜ì • í•„ìš” |

### 4.4 GatewayWorker ë°°í¬ (P0)

í˜„ì¬ `src/api_gateway/worker.py`ëŠ” ìŠ¤í„°ë¸Œ ìƒíƒœì´ë©° ë¯¸ë°°í¬ì…ë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¥¼ ì¦‰ì‹œ ì‹¤í–‰í•©ë‹ˆë‹¤:

1. **ì™„ì„±**: `worker.py` ì‹¤ì œ API í˜¸ì¶œ ë¡œì§ êµ¬í˜„
2. **ë°°í¬**: `docker-compose.yml`ì— `gateway-worker` ì„œë¹„ìŠ¤ ì¶”ê°€
3. **ì „í™˜**: ëª¨ë“  REST API í˜¸ì¶œì„ Queue ê¸°ë°˜ìœ¼ë¡œ ì „í™˜ (ì„ íƒì )

### 4.5 Container-based E2E Verification & CI Fail-Fast [UPDATED]
**ë°°ê²½**: ìš´ì˜ í™˜ê²½ì˜ ì˜¤ì„¤ì •ì´ ë°°í¬ ë‹¨ê³„ì—ì„œ ê²€ì¶œë˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì¥ì• ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ 'ì„±ê³µ'ë¿ë§Œ ì•„ë‹ˆë¼ 'ì˜ë„ëœ ì‹¤íŒ¨'ë¥¼ CIì—ì„œ ê²€ì¦í•¨.

#### A. Self-Diagnosis & Container Health [STRICT]
- **Fail-Fast**: í•„ìˆ˜ ë³€ìˆ˜ ëˆ„ë½ ì‹œ ì¦‰ì‹œ ì¢…ë£Œ(`Exit 1`)ë¥¼ ë„˜ì–´ì„œ, CI ê°€ìƒ í™˜ê²½ì—ì„œ ì‹¤ì œ ì¢…ë£Œ ì½”ë“œ(Non-zero)ë¥¼ ê²€ì¶œí•¨.
- **Docker Healthcheck**: `docker-compose.yml`ì— ì „ìš© í—¬ìŠ¤ì²´í¬ ë„ì….
  ```yaml
  healthcheck:
    test: ["CMD", "python", "-c", "import sys; from src.core.health import check; sys.exit(0 if check() else 1)"]
    interval: 30s
    timeout: 10s
    retries: 3
  ```

#### B. CI Negative Smoke Test (Pillar 3 Verification)
- **`smoke_test.sh` í™•ì¥**:
  1. **Positive Test**: ì •ìƒì ì¸ `.env.prod` ì£¼ì… ì‹œ 30ì´ˆ ì´ìƒ ê°€ë™ í™•ì¸.
  2. **Negative Test**: í•„ìˆ˜ í‚¤(`KIS_API_KEY`)ë¥¼ ê³ ì˜ë¡œ ì œê±°í•œ í™˜ê²½ì—ì„œ ì»¨í…Œì´ë„ˆê°€ 10ì´ˆ ì´ë‚´ì— `Exited (1)` ìƒíƒœë¡œ ì „ì´ë˜ëŠ”ì§€ ê²€ì¦.
- **CI ì°¨ë‹¨**: ë„¤ê±°í‹°ë¸Œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨(ì¦‰, ì„¤ì • ì˜¤ë¥˜ì—ë„ ì»¨í…Œì´ë„ˆê°€ ì£½ì§€ ì•Šê³  ë–  ìˆëŠ” ê²½ìš°) ì‹œ PR ë¨¸ì§€ë¥¼ ìë™ ì°¨ë‹¨í•¨.

---

## 5. Council Review

### ğŸ‘” PM (Project Manager)
> "ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œ 'ì°¸ê°’(Ground Truth)'ì€ ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ì˜ ì‹ ë¢°ë„ë¥¼ ì¢Œìš°í•˜ëŠ” í•µì‹¬ì…ë‹ˆë‹¤. REST API ë¶„ë´‰ì€ ê±°ë˜ì†Œ ê³µì‹ ë°ì´í„°ì´ë¯€ë¡œ ë²•ì  ë¶„ìŸì´ë‚˜ ê°ì‚¬ ì‹œ ìœ ì¼í•˜ê²Œ ì¸ì •ë°›ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°ì…ë‹ˆë‹¤."

### ğŸ›ï¸ Architect
> "ì•„í‚¤í…ì²˜ ê´€ì ì—ì„œ ë³¼ ë•Œ, í‹± ë°ì´í„°ëŠ” 'ì›ì²œ(Raw Source)'ì´ê³  ë¶„ë´‰ì€ 'íŒŒìƒ(Derived)'ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í‹± ìˆ˜ì§‘ ê³¼ì •ì—ì„œ ëˆ„ë½ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, REST API ë¶„ë´‰ì„ 'ê²€ì¦ ê¸°ì¤€(Validation Reference)'ìœ¼ë¡œ ì‚¼ì•„ í‹± ë°ì´í„°ì˜ ì™„ì „ì„±ì„ êµì°¨ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì˜¬ë°”ë¥¸ êµ¬ì¡°ì…ë‹ˆë‹¤."

### ğŸ”¬ Data Scientist
> "í†µê³„ì  ê´€ì ì—ì„œ REST API ë¶„ë´‰ì€ 'ëª¨ì§‘ë‹¨(Population)'ì— ê°€ê¹ê³ , í‹± ì§‘ê³„ ë¶„ë´‰ì€ 'í‘œë³¸(Sample)'ì— ê°€ê¹ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµ ë°ì´í„°ë‚˜ ë°±í…ŒìŠ¤íŒ…ìš© ìµœì¢… ë°ì´í„°ì…‹ì€ ë°˜ë“œì‹œ 'REST API ë¶„ë´‰'ì„ Ground Truthë¡œ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤."

### ğŸ—ï¸ Infra
> "ì¸í”„ë¼ ê´€ì ì—ì„œ REST APIëŠ” ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ì´ë¯€ë¡œ í˜¸ì¶œëŸ‰ì„ ì—„ê²©íˆ í†µì œí•´ì•¼ í•©ë‹ˆë‹¤. ëª¨ë“  REST API í˜¸ì¶œì€ ë°˜ë“œì‹œ `RedisRateLimiter`ë¥¼ ê²½ìœ í•´ì•¼ í•˜ë©°, ì´ë¥¼ ê°•ì œí•˜ê¸° ìœ„í•´ `GatewayWorker` íŒ¨í„´ì„ ë„ì…í•˜ëŠ” ê²ƒì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤."

### ğŸ’» Developer
> "ê°œë°œì ì…ì¥ì—ì„œ 'ì°¸ê°’'ì´ ëª…í™•í•˜ì§€ ì•Šìœ¼ë©´ ì½”ë“œ ê³³ê³³ì—ì„œ í˜¼ë€ì´ ë°œìƒí•©ë‹ˆë‹¤. ëª…í™•í•œ ìš°ì„ ìˆœìœ„ë¥¼ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤: 1ìˆœìœ„ = REST API ë¶„ë´‰, 2ìˆœìœ„ = Volume Check í†µê³¼í•œ í‹± ì§‘ê³„, 3ìˆœìœ„ = Manual Review."

### ğŸ›¡ï¸ QA
> "í’ˆì§ˆ ë³´ì¦ ê´€ì ì—ì„œ 'ì°¸ê°’'ì€ ì¬í˜„ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤. REST APIëŠ” ê³¼ê±° ë°ì´í„°ë¥¼ ì–¸ì œë“  ë‹¤ì‹œ ì¡°íšŒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ 'ì¬í˜„ ê°€ëŠ¥í•œ ì°¸ê°’'ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ìµœì¢… ê²€ì¦ ë° í’ˆì§ˆ ë¦¬í¬íŠ¸ëŠ” ë°˜ë“œì‹œ REST API ê¸°ì¤€ìœ¼ë¡œ ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤."

**PM Final Decision**: âœ… **ë§Œì¥ì¼ì¹˜ ìŠ¹ì¸** (2026-01-22)

---

## 6. Implementation Plan

### Phase 1: ì •ì±… ë¬¸ì„œí™” (Week 1)
- [x] RFC-009 ì‘ì„± ë° ìŠ¹ì¸
- [ ] `ground_truth_policy.md` ì‘ì„±
- [ ] `BACKLOG.md` ì—…ë°ì´íŠ¸

### Phase 2: ì½”ë“œ ìˆ˜ì • (Week 1-2)
- [x] `BackfillManager.fetch_real_ticks()`: gatekeeper í†µí•© âœ… 2026-01-22
- [x] `RecoveryOrchestrator.run_hybrid_recovery()`: gatekeeper í†µí•© (via BackfillManager) âœ… 2026-01-22
- [x] `impute_final_candles.py`: ì°¸ê°’ ìš°ì„ ìˆœìœ„ ë¡œì§ ì ìš© âœ… 2026-01-22
- [x] Database Migration: `source_type` ì»¬ëŸ¼ ì¶”ê°€ (`006_add_source_type_to_candles.sql`) âœ… 2026-01-22

### Phase 3: ì¸í”„ë¼ ë°°í¬ (Week 2)
- [x] Redis ë¬¼ë¦¬ì  ë¶„ë¦¬ (ë³„ë„ ì»¨í…Œì´ë„ˆ `redis-gatekeeper`) âœ… 2026-01-22
- [ ] `GatewayWorker` ì‹¤ì œ êµ¬í˜„ ë° ë°°í¬ (ì„ íƒì )

### Phase 4: ê²€ì¦ (Week 3)
- [ ] Rate Limit í…ŒìŠ¤íŠ¸ (ë©€í‹° ì›Œì»¤ í™˜ê²½)
- [ ] **Container-based E2E Verification**: ì‹¤ì œ ìš´ì˜ í¬íŠ¸ ëª¨ì‚¬ í…ŒìŠ¤íŠ¸
- [ ] **Self-Diagnosis Unit Test**: í™˜ê²½ë³€ìˆ˜ ëˆ„ë½ ì‹œ Fail-Fast í™•ì¸
- [ ] Ground Truth ì •ì±… ê²€ì¦ (ìƒ˜í”Œ ë°±í…ŒìŠ¤íŠ¸)
- [ ] 1ì£¼ì¼ íŒŒì¼ëŸ¿ ìš´ì˜

---

## 7. Risks & Mitigation

| Risk | Impact | Mitigation | Priority |
|------|--------|------------|----------|
| **API í•œë„ ì´ˆê³¼** | ì„œë¹„ìŠ¤ ì¤‘ë‹¨ | GatewayWorker ìš°ì„  ë°°í¬ | **P0** |
| **ë ˆê±°ì‹œ ì½”ë“œ ë¯¸ë°œê²¬** | 429 ì—ëŸ¬ ë°œìƒ | Grep ê²€ìƒ‰ + Linter ì¶”ê°€ | **P1** |
| **DB ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨** | ë°ì´í„° ì†ì‹¤ | ë°±ì—… ì„ í–‰, Rollback ê³„íš | **P1** |

---

## 8. Success Metrics

- [ ] ëª¨ë“  REST API í˜¸ì¶œë¶€ì— `gatekeeper` ì ìš©ë¥  = 100%
- [ ] 429 ì—ëŸ¬ ë°œìƒë¥  = 0%
- [ ] ë°±í…ŒìŠ¤íŒ… ê²°ê³¼ ì¬í˜„ìœ¨ = 100%
- [ ] Ground Truth ì •ì±… ì¤€ìˆ˜ìœ¨ = 100%

---

## 9. References

- [RFC-007: Collector Isolation](RFC-007-collector-isolation.md)
- [RFC-008: Tick Completeness QA](RFC-008-tick-completeness-qa.md)
- [ISSUE-031: Hybrid Recovery](../../ARCHIVE/issues/ISSUE-031.md)
- [Implementation Plan](file:///home/ubuntu/.gemini/antigravity/brain/2946b5bd-9ff9-4259-bafd-06812bdf13a2/implementation_plan.md)
- [ID-hybrid-multi-vendor-validation.md](../../ideas/ID-hybrid-multi-vendor-validation.md)

---

**Status Update**: âœ… Approved by Council of Six (2026-01-22)  
**Next Steps**: Phase 2 ì‹¤í–‰ (BackfillManager ë° RecoveryOrchestrator gatekeeper í†µí•©)
